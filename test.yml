mirror:
  # Defines the upstream mirrors.
  #
  # The key denotes the internal mirror name within aptly.
  google-chrome:
    components: [ "main" ]
    architectures: [ "amd64", "i386" ]
    distribution: "stable"
    archive: "http://dl.google.com/linux/chrome/deb/"
    gpg-keys: ["7FAC5991"]
    gpg-urls: ["https://dl.google.com/linux/linux_signing_key.pub"]
repo:
  symonitoring:
    architectures: [ "amd64", "i386" ]
    distribution: "stable"
    component: "main"
    comment: "yea baby"
snapshot:
  google-chrome-latest:
    mirror: "google-chrome"
  google-chrome-stable:
    filter: { "source": "google-chrome-latest", "query": "google-chrome-stable" }
  google-weekly-%T:
    mirror: "google-chrome"
    timestamp:
      # Timestamp spec: If repeat-weekly is present, then the timestamp will be
      # created for the last day matching the given weekday. The time is used
      # to set the time of day when the snapshot "rolls over".
      #
      # Weekdays are denoted in english 3-letter abbreviations. Time is denoted
      # in 24 hour HH:MM format and assumed to be UTC.
      #
      # Example:
      #   - repeat-weekly set to monday, time set to 00:00:
      #      - executed on monday 01:00: a new snapshot is created labelled
      #        with the timestamp of monday (ex. 20151102T0000Z).
      #      - executed on tuesday, 02:00: nothing happens, as there is already
      #        a snapshot matching the "last" repeat date
      repeat-weekly: "mon"
      time: "00:00"
  google-daily-%T:
    mirror: "google-chrome"
    timestamp:
      time: "00:00"
  foobar-%T:
    timestamp: {"time": "00:00"}
    merge:
      # References to snapshots can be either a single name, or a dict
      # describing a timestamped snapshot. That dict must have two keys,
      # "name" and "timestamp". "name" is the timestamp placeholder and
      # must match a corresponding placeholder name in the snapshots spec.
      # The "timestamp" key is a number that references the "age" of timestamp
      # to be referenced: 0 means the most current, 1 the previous one, etc.
      # Instead of 0, you may also use the string "current", and instead of 1,
      # you may use the string "previous".
      - { "name": "google-daily-%T", "timestamp": 0 }
      - "google-chrome-latest"

publish:
  # Defines the publishing endpoints.
  #
  # The key denotes the target, for example: 'ubuntu/latest' will create an
  # endpoint at http://<server>/ubuntu/latest/
  google-chrome/latest:
    -
      distribution: "latest"
      architectures: [ "amd64", "i386" ]
      components: "main"
      snapshots:
        -
          name: "foobar-%T"
          timestamp: "current"
          archive-on-update: "archived-chrome-%T"
      gpg-key: "650FE755"
      origin: "yeah whatever"
      automatic-update: true

  google-chrome/last-stable:
    -
      distribution: "latest"
      architectures: [ "amd64", "i386" ]
      components: "main"
      publish: "google-chrome/latest"
      gpg-key: "650FE755"
      origin: "yeah whatever"
      automatic-update: false
